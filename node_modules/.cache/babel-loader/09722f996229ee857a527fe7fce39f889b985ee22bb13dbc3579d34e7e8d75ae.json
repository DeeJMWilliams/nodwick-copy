{"ast":null,"code":"import _toConsumableArray from\"/Users/deewilliams/Developer/projects/nodwick-copy/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/deewilliams/Developer/projects/nodwick-copy/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/deewilliams/Developer/projects/nodwick-copy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//React\nimport React,{useState}from'react';//Bootstrap\nimport ListGroup from'react-bootstrap/ListGroup';import Badge from'react-bootstrap/Badge';//Redux\nimport{useSelector,useDispatch}from'react-redux';import{selectLocations,editLocation}from'../slices/allLocationSlice.tsx';import{selectLocation,setLocation}from'../slices/locationSlice.tsx';import{setLocationItems,selectLocationItems}from'../slices/locationItemSlice.tsx';import{selectDraggedItem,resetDraggedItem}from'../slices/dragSlice.tsx';//Types\n//Components\nimport LocationDeletePopup from'./LocationDeletePopup.tsx';import LocationEditPopup from'./LocationEditPopup.tsx';//Methods\nimport{moveItem,getLocation}from'../methods.tsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LocationList=function LocationList(_ref){var type=_ref.type;var dispatch=useDispatch();var locations=useSelector(selectLocations);var activeLocation=useSelector(selectLocation);var draggedItem=useSelector(selectDraggedItem);var locationItems=useSelector(selectLocationItems);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),deleting=_useState2[0],setDeleting=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editing=_useState4[0],setEditing=_useState4[1];var _useState5=useState(activeLocation),_useState6=_slicedToArray(_useState5,2),destination=_useState6[0],setDestination=_useState6[1];var checkDelete=function checkDelete(location){dispatch(setLocation(location));setDeleting(true);};var startEdit=function startEdit(location){dispatch(setLocation(location));setEditing(true);};var handleDragOver=function handleDragOver(event,loc){event.preventDefault();if(destination.lid!==loc.lid){setDestination(loc);}};var handleDragLeave=function handleDragLeave(event,loc){event.preventDefault();if(destination.lid===loc.lid){setDestination({'name':'','lid':'','gid':'',type:'location',timestamp:'',item_ids:[]});}};var handleDrop=function handleDrop(loc){if(draggedItem.lid!==loc.lid){moveItem(loc.lid,draggedItem.gid,draggedItem.lid,draggedItem.iid).then(function(){//Add new item ID to new location\ndispatch(editLocation(_objectSpread(_objectSpread({},loc),{},{item_ids:[].concat(_toConsumableArray(loc.item_ids),[draggedItem.iid])})));getLocation(draggedItem.gid,draggedItem.lid).then(function(response){//Remove item ID from old location\nvar newItems=response.data.item_ids.filter(function(item_id){return item_id!==draggedItem.iid;});dispatch(editLocation(_objectSpread(_objectSpread({},response.data),{},{item_ids:_toConsumableArray(newItems)})));//Rerender location items\ndispatch(setLocationItems(locationItems.filter(function(item){return newItems.includes(item.iid);})));});}).catch(function(e){return console.log(e);});}setDestination({'name':'','lid':'','gid':'',type:'location',timestamp:'',item_ids:[]});dispatch(resetDraggedItem());};var LocationListItem=function LocationListItem(_ref2){var location=_ref2.location;var selected=location.lid===activeLocation.lid;return/*#__PURE__*/_jsx(\"div\",{className:\"droppable\",onDragOver:function onDragOver(e){return handleDragOver(e,location);},onDragLeave:function onDragLeave(e){return handleDragLeave(e,location);},onDrop:function onDrop(){return handleDrop(location);},children:/*#__PURE__*/_jsxs(ListGroup.Item,{onClick:function onClick(){return dispatch(setLocation(location));},className:\"location__entry \".concat(selected?'active':''),variant:location.lid===destination.lid?'primary':'',children:[/*#__PURE__*/_jsx(\"span\",{className:\"location__text\",children:location.name}),location.name!=='Unassigned'?/*#__PURE__*/_jsxs(\"div\",{className:\"badges\",children:[/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",onClick:function onClick(){return startEdit(location);},children:\"\\u270E\"}),' ',/*#__PURE__*/_jsx(Badge,{bg:\"danger\",onClick:function onClick(){return checkDelete(location);},children:\"x\"})]}):/*#__PURE__*/_jsx(React.Fragment,{})]})},location.lid);};var locationsOfType=locations.filter(function(location){return location.type===type;});return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(LocationEditPopup,{active:editing,toggle:function toggle(){return setEditing(false);}}),/*#__PURE__*/_jsx(LocationDeletePopup,{active:deleting,toggle:function toggle(){return setDeleting(false);}}),/*#__PURE__*/_jsx(ListGroup,{children:locationsOfType.length>=1?locationsOfType.map(function(location){return/*#__PURE__*/_jsx(LocationListItem,{location:location},location.lid);}):/*#__PURE__*/_jsx(ListGroup.Item,{children:\"No entries yet!\"})})]});};export default LocationList;","map":{"version":3,"names":["React","useState","ListGroup","Badge","useSelector","useDispatch","selectLocations","editLocation","selectLocation","setLocation","setLocationItems","selectLocationItems","selectDraggedItem","resetDraggedItem","LocationDeletePopup","LocationEditPopup","moveItem","getLocation","jsx","_jsx","jsxs","_jsxs","LocationList","_ref","type","dispatch","locations","activeLocation","draggedItem","locationItems","_useState","_useState2","_slicedToArray","deleting","setDeleting","_useState3","_useState4","editing","setEditing","_useState5","_useState6","destination","setDestination","checkDelete","location","startEdit","handleDragOver","event","loc","preventDefault","lid","handleDragLeave","timestamp","item_ids","handleDrop","gid","iid","then","_objectSpread","concat","_toConsumableArray","response","newItems","data","filter","item_id","item","includes","catch","e","console","log","LocationListItem","_ref2","selected","className","onDragOver","onDragLeave","onDrop","children","Item","onClick","variant","name","bg","Fragment","locationsOfType","active","toggle","length","map"],"sources":["/Users/deewilliams/Developer/projects/nodwick-copy/src/components/LocationList.tsx"],"sourcesContent":["//React\nimport React, {useState} from 'react';\n//Bootstrap\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Badge from 'react-bootstrap/Badge';\n//Redux\nimport {useSelector, useDispatch} from 'react-redux';\nimport { selectLocations, editLocation } from '../slices/allLocationSlice.tsx';\nimport {selectLocation, setLocation} from '../slices/locationSlice.tsx';\nimport {setLocationItems, selectLocationItems} from '../slices/locationItemSlice.tsx';\nimport { selectDraggedItem, resetDraggedItem } from '../slices/dragSlice.tsx';\n//Types\nimport {Location, Item} from '../types.tsx';\n//Components\nimport LocationDeletePopup from './LocationDeletePopup.tsx';\nimport LocationEditPopup from './LocationEditPopup.tsx';\n//Methods\nimport { moveItem, getLocation } from '../methods.tsx';\n\ntype locationProps = {\n    type:string;\n}\n\nconst LocationList = ({type}:locationProps):JSX.Element => {\n    const dispatch = useDispatch();\n    const locations:Location[] = useSelector(selectLocations);\n    const activeLocation:Location = useSelector(selectLocation);\n    const draggedItem:Item = useSelector(selectDraggedItem);\n    const locationItems:Item[] = useSelector(selectLocationItems);\n    const [deleting, setDeleting] = useState(false);\n    const [editing, setEditing] = useState(false);\n    const [destination, setDestination] = useState(activeLocation);\n\n    type ListItemProps = {\n        location:Location;\n    }\n\n    const checkDelete = (location:Location):void => {\n        dispatch(setLocation(location));\n        setDeleting(true);\n    }\n\n    const startEdit = (location:Location):void => {\n        dispatch(setLocation(location));\n        setEditing(true);\n    }\n\n    const handleDragOver = (event:React.DragEvent, loc:Location):void => {\n        event.preventDefault();\n        if (destination.lid !== loc.lid) {\n            setDestination(loc);\n        }\n    }\n\n    const handleDragLeave = (event:React.DragEvent, loc:Location):void => {\n        event.preventDefault();\n        if (destination.lid === loc.lid) {\n            setDestination({'name': '', 'lid': '', 'gid': '', type: 'location', timestamp: '', item_ids: []});\n        }\n    }\n\n    const handleDrop = (loc:Location):void => {\n        if (draggedItem.lid !== loc.lid) {\n            moveItem(loc.lid, draggedItem.gid, draggedItem.lid, draggedItem.iid)\n            .then(() => {\n                //Add new item ID to new location\n                dispatch(editLocation({...loc, item_ids: [...loc.item_ids, draggedItem.iid]}))\n                getLocation(draggedItem.gid, draggedItem.lid)\n                .then(response => {\n                    //Remove item ID from old location\n                    const newItems:string[] = response.data.item_ids.filter((item_id:string) => item_id !== draggedItem.iid);\n                    dispatch(editLocation({...response.data, item_ids: [...newItems]}));\n                    //Rerender location items\n                    dispatch(setLocationItems(locationItems.filter(item => newItems.includes(item.iid))));\n                })\n            })\n            .catch(e => console.log(e))\n        }\n        setDestination({'name': '', 'lid': '', 'gid': '', type: 'location', timestamp: '', item_ids: []});\n        dispatch(resetDraggedItem());\n    }\n    \n    const LocationListItem = ({location}: ListItemProps):JSX.Element => {\n        let selected = location.lid === activeLocation.lid;\n        return <div className=\"droppable\" \n                onDragOver={(e) => handleDragOver(e, location)}\n                onDragLeave = {(e) => handleDragLeave(e, location)}\n                onDrop={() => handleDrop(location)}\n                key={location.lid}>\n                <ListGroup.Item \n                onClick={()=> dispatch(setLocation(location))} \n                className={`location__entry ${selected ? 'active': ''}`}\n                variant={location.lid === destination.lid ? 'primary': ''}>\n                    <span className=\"location__text\">\n                    {location.name}\n                    </span>\n                {location.name !== 'Unassigned' ? \n                <div className=\"badges\">\n                    <Badge bg=\"secondary\" onClick={() => startEdit(location)}>✎</Badge>{' '}\n                    <Badge bg=\"danger\" onClick={() => checkDelete(location)}>x</Badge>\n                </div> :\n                <React.Fragment></React.Fragment>}\n                </ListGroup.Item>\n                </div>\n    }\n\n    const locationsOfType = locations.filter((location:Location) => location.type === type);\n\n\n    return(\n        <React.Fragment>\n            <LocationEditPopup active={editing} toggle={() => setEditing(false)} />\n            <LocationDeletePopup active={deleting} toggle={() => setDeleting(false)} />\n            <ListGroup>\n                {locationsOfType.length >= 1 ?\n                locationsOfType.map((location:Location) => {return <LocationListItem location={location} key={location.lid}/>}) :\n                <ListGroup.Item>No entries yet!</ListGroup.Item>}\n            </ListGroup>\n        </React.Fragment>\n    )\n}\n\nexport default LocationList;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}