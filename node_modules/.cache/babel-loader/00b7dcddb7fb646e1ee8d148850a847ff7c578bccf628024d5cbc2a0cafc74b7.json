{"ast":null,"code":"import _slicedToArray from\"/Users/deewilliams/Developer/projects/nodwick-copy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//React & Routing\nimport{useState,useEffect}from'react';import{Routes,Route}from'react-router-dom';import{useNavigate}from'react-router-dom';//Pages\nimport Games from'./pages/Games.tsx';import Login from'./pages/Login.tsx';import Inventory from'./pages/Inventory.tsx';import Callback from'./pages/Callback.tsx';//Types\n//Redux\nimport{useSelector,useDispatch}from'react-redux';import{selectUser,changeUser}from'./slices/userSlice.tsx';import{selectGame}from'./slices/gameSlice.tsx';//Styling\nimport'./App.css';//Auth\nimport{useAuth0}from'@auth0/auth0-react';//Methods\nimport{addUser,getUsers,getSingleUser}from'./methods.tsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useAuth=useAuth0(),user=_useAuth.user;var dispatch=useDispatch();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),alert=_useState2[0],setAlert=_useState2[1];var activeUser=useSelector(selectUser);var activeGame=useSelector(selectGame);var navigate=useNavigate();//Move to games page on successful login\nuseEffect(function(){if(activeUser.uid){navigate('/games');}},[activeUser,navigate]);//Move to inventory page on set of active game or games page on removal of active game\nuseEffect(function(){if(activeGame.gid&&activeUser.uid){navigate('/inventory');}else if(activeUser.uid){navigate('/games');}},[activeGame,activeUser,navigate]);var defineUser=function defineUser(user){return{name:user.nickname,email:user.email,uid:user.sub,game_ids:[]};};var getUserData=function getUserData(user){getUsers().then(function(response){if(!response.data.map(function(user){return user.uid;}).includes(user.sub)){createNewUser(user);}else{getSingleUser(user.sub).then(function(response){dispatch(changeUser(response.data));});}}).catch(function(e){return console.log(e);});};var createNewUser=function createNewUser(user){var userData=defineUser(user);addUser(userData).then(function(response){dispatch(changeUser(response.data));});};//Set active user on login\nuseEffect(function(){if(user){getUserData(user);}},[user]);return/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Login,{alertText:alert})}),/*#__PURE__*/_jsx(Route,{path:\"/games\",element:/*#__PURE__*/_jsx(Games,{})}),/*#__PURE__*/_jsx(Route,{path:\"/inventory\",element:/*#__PURE__*/_jsx(Inventory,{})}),/*#__PURE__*/_jsx(Route,{path:\"/callback\",element:/*#__PURE__*/_jsx(Callback,{})})]});};export default App;","map":{"version":3,"names":["useState","useEffect","Routes","Route","useNavigate","Games","Login","Inventory","Callback","useSelector","useDispatch","selectUser","changeUser","selectGame","useAuth0","addUser","getUsers","getSingleUser","jsx","_jsx","jsxs","_jsxs","App","_useAuth","user","dispatch","_useState","_useState2","_slicedToArray","alert","setAlert","activeUser","activeGame","navigate","uid","gid","defineUser","name","nickname","email","sub","game_ids","getUserData","then","response","data","map","includes","createNewUser","catch","e","console","log","userData","children","path","element","alertText"],"sources":["/Users/deewilliams/Developer/projects/nodwick-copy/src/App.tsx"],"sourcesContent":["//React & Routing\nimport {useState, useEffect} from 'react';\nimport {Routes, Route} from 'react-router-dom';\nimport {useNavigate} from 'react-router-dom';\n//Pages\nimport Games from './pages/Games.tsx';\nimport Login from './pages/Login.tsx';\nimport Inventory from './pages/Inventory.tsx';\nimport Callback from './pages/Callback.tsx';\n//Types\nimport {User, Game} from './types.tsx';\n//Redux\nimport {useSelector, useDispatch} from 'react-redux';\nimport {selectUser, changeUser} from './slices/userSlice.tsx';\nimport {selectGame} from './slices/gameSlice.tsx';\n//Styling\nimport './App.css';\n//Auth\nimport {useAuth0} from '@auth0/auth0-react';\n//Methods\nimport {addUser, getUsers, getSingleUser} from './methods.tsx';\n\nconst App = (): JSX.Element => {\n  const {user} = useAuth0();\n  const dispatch = useDispatch();\n  const [alert, setAlert] = useState('');\n  const activeUser:User = useSelector(selectUser);\n  const activeGame:Game = useSelector(selectGame);\n  const navigate = useNavigate();\n\n  //Move to games page on successful login\n  useEffect(() => {\n    if (activeUser.uid) {\n      navigate('/games');\n    } \n  }, [activeUser, navigate]);\n\n  //Move to inventory page on set of active game or games page on removal of active game\n  useEffect(() => {\n    if (activeGame.gid && activeUser.uid) {\n      navigate('/inventory');\n    } else if (activeUser.uid) {\n      navigate('/games');\n    }\n  }, [activeGame, activeUser, navigate]);\n\n  const defineUser = (user) => {\n    return {\n      name: user.nickname,\n      email: user.email,\n      uid: user.sub,\n      game_ids: [],\n    }\n  }\n\n  const getUserData = (user) => {\n    getUsers()\n    .then(response => {\n      if (!response.data.map(user => user.uid).includes(user.sub)) {\n        createNewUser(user);\n      } else {\n        getSingleUser(user.sub)\n        .then(response => {\n          dispatch(changeUser(response.data));\n        })\n      }\n    })\n    .catch(e => console.log(e))\n  }\n\n  const createNewUser = (user) => {\n    const userData =  defineUser(user);\n    addUser(userData)\n    .then(response => {\n      dispatch(changeUser(response.data));\n    })\n  }\n\n  //Set active user on login\n  useEffect(() => {\n    if (user) {\n      getUserData(user);\n    }\n  }, [user])\n\n  return (\n      <Routes>\n        <Route path='/' element={<Login alertText={alert} />} />\n        <Route path='/games' element={<Games />} />\n        <Route path='/inventory'  element={<Inventory />} />\n        <Route path='/callback' element={<Callback />} />\n      </Routes>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}